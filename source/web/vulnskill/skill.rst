挖掘思路
========================================

文件上传漏洞
----------------------------------------
+ FUZZ上传参数
    - 对upload.php空白界面FUZZ参数名，爆破参数值，出现上传表单后上传shell。
+ 绕过文件类型检测
    - 修改type、fileType、breach等参数为0、1、2或all，绕过文件类型检测，上传成功。
+ IE上传绕过
    - 用IE打开上传点，上传马子，通过filename="1.asp";filename="1.jpg"绕过检测。

XSS
----------------------------------------
+ WAF绕过
    - 输出在JS内的闭合与注释；使用Function()代替eval()；atob解密base64加密的JS，绕过对alert()的过滤；反引号代替括号与引号，绕过对()的过滤。
+ 存储型XSS与换绑验证码组合
    - 通过存储型XSS与换绑的验证码输出在前端的组合，实现任意账户无感换绑。

SSRF漏洞
----------------------------------------
+ FUZZ目录与参数名
    - 通过FUZZ目录、参数名得到/xxx?image_url=xx，直接无脑get一个SSRF漏洞。
+ 修改imageurl参数
    - 将imageurl参数修改为dnslog地址，探测内网或云服务器元数据。

越权
----------------------------------------
+ **水平越权** :删除openid参数获取所有用户信息，用得到的账号用户名进行喷洒，成功登录。
+ **管理员token获取** :修改username参数为admin，返回管理员token，复用此凭证访问敏感接口。
+ **弱cookie问题** :修改cookie的UserCode值为admin，直接获得管理员权限，尝试SQL注入成功。
+ **修改POST参数** ：修改POST参数username为admin获得管理员权限，重置管理员密码。

注册登录类漏洞
----------------------------------------

登录
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+ **session_key泄漏** ：通过session_key和iv解密encrypteData参数，越权篡改数据，实现任意账号登录。

注册
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+ **MySQL数据截断** ：insert into数据长度溢出时截断数据，导致注册时的任意用户覆盖。
+ **账号激活链接未加密** ：通过构造激活链接实现任意用户注册。
+ **userGroupId遍历** ：通过遍历userGroupId以更高权限注册，提升权限。

验证码
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+ **验证码未绑定** ：只校验验证码是否有效，导致任意用户登录。
+ **验证码绕过** ：NULL，true或者直接置空。
+ **验证码回显在set-cookie中** ：通过set-cookie中的验证码回显绕过验证。
+ **万能、默认验证码** ：使用万能或默认验证码绕过验证。
+ **验证码4-5位可爆破** ：通过爆破4-5位验证码绕过验证。

密码重置
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+ **任意用户密码重置** :登录接口遍历手机号，密码重置时将手机号替换为其他手机号，成功重置密码。
+ **邮箱密码重置链接凭证不绑定账号** ：通过修改账号ID实现任意用户密码重置。
+ **前端校验关键数据** ：前端校验关键数据（如手机号）导致任意换绑，实现任意用户密码重置。

支付类漏洞
----------------------------------------
+ **订单信息泄露** :输入手机号获取对应订单信息，滞空手机号返回所有用户信息。
+ **并发漏洞** ：通过并发漏洞进行重放攻击。
+ **优惠券多次复用** ：尝试多次复用优惠券。
+ **购买售罄商品** ：尝试购买售罄的商品。
+ **参数遍历** ：通过参数遍历寻找隐藏商品、赠品、附属商品，实现0元购。
+ **四舍五入数据处理不当** ：导致支付逻辑漏洞或越权逻辑漏洞。

其它逻辑漏洞
----------------------------------------
+ **未授权接口寻找** ：通过FUZZ、405改请求方法、5xx错误寻找未授权接口。
+ **403 Bypass** ：通过FUZZ爆破次级目录或403 Bypass绕过限制。
+ **虚假锁定** ：账号锁定后，通过输入正确密码是否可登录判断。
+ **输入校验过滤不严** ：导致二次注入、二次XSS。
+ **DDOS攻击** ：通过修改查询范围，拉满处理能力，达到拒绝服务效果。
+ **前端数据截图伪造** ：通过前端数据截图伪造与水平越权数据泄露的组合，实现退款欺骗。

