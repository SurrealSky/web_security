攻防路径
========================================

Web攻击常见模式
----------------------------------------
|attackmushi|

Web安全技术学习路线
----------------------------------------
|web-sec-learn|

渗透测试
----------------------------------------

简介
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
渗透测试(penetration test)是指渗透人员在不同的位置（比如从内网、从外网等位置）利用各种手段对某个特定网络进行 **测试** ，以期发现和挖掘系统中存在的漏洞，然后输出 **渗透测试报告** ，并提交给网络所有者。即通过模拟恶意黑客的攻击方法，来评估计算机网络系统安全的一种评估方法。

特点
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
- 渐进的并且逐步深入的过程。
- 选择不影响业务系统正常运行的攻击方法进行的测试。

流程和手段
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
|STCS2|

|STCS|

二进制漏洞挖掘
----------------------------------------

分析利用
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
根据CVE,CNVD等平台公布的漏洞情况，分析目标是否具有此类漏洞，进行攻击利用。

挖掘
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

- 手动法漏洞挖掘
	即不使用自动挖掘工具，手动分析软件可能出问题的地方。其中挖掘点是靠手动来寻找的，畸形数据也是手动来构造的。

	一般思路：
	
	- 确定挖掘点：凡是用户可控的数据点都可以作为挖掘点。包括程序路径，输入消息，文件内配置信息等等。由于是手动挖掘，因此挖掘点不适合选择的过于复杂。很明显office系列，各种图片声音等等这样复杂的文件格式，是不适合定位于手动挖掘点的。
	- 对挖掘点填充畸形数据：找到挖掘点后，就可以对挖掘点填充各种畸形数据。其中包括超长字符串，畸形字符，边界值数据等等。根据长期的挖掘经验来看，其中超长字符串的效果更好。并且超长字符串一般都为堆栈溢出，该漏洞一般情况下都是可以利用的。
	- 程序是否发生异常：程序崩溃，程序退出等。
	- 分析：如果发生异常，用反汇编工具和汇编级调试器深入分析(如WINDBG IDA OLLYDBG），找到异常原因，判断漏洞类型以及危害。
	
	::

		优点：不需要专业的fuzz工具，并且测试的漏洞主要是堆栈溢出漏洞，原理较为简单。
		因此手动挖掘的速度是非常快的，效率也是比较高的。可以在几十分钟内发现可利用的缓冲区溢出漏洞。
	
	::

		缺点：
		相对于文件格式漏洞难以挖掘。因为文件格式的处理逻辑一般都较为复杂，关于这一点手动挖掘方法效果不是很好。
	
- 通用fuzz法漏洞挖掘
	即在不研究文件格式的情况下，用自动化测试工具对目标程序进行fuzz测试。
	
	一般思路：
	
	- 选取目标文件。
	- 使用工具对目标文件的格式进行变异，生成大量的畸形样本。
	- 让程序分别载入并解析这些畸形样本，监测程序是否会触发异常。
	- 通过逆向分析这些异常样本，查看是否是漏洞同时确定危害级别。
	
	::
	
		优点：上手容易，不需要了解文件格式即可对目标进行漏洞挖掘。全自动化，效率很高。
		
	::
	
		缺点：测试深度不够，只适合一些文件结构较为简单的文件格式，对复杂的文件格式无能为力。
		
	相关工具：Easyfuzzer。
	
- 智能fuzz法漏洞挖掘
	智能fuzz是对文件的结构进行分析，编写出表述文件结构的代码。然后fuzzer工具根据该代码的约束生成畸形样本，接下来就和通用fuzz相同了：执行畸形样本，监控异常。
	
	一般思路：
	
	- 研究要挖掘程序处理的相应文件格式，包括该格式的各种数据结构，约束规则等信息。
	- 根据fuzzer规定的代码规则，编写相应规则的代码，来解析当前文件格式的结构。
	- 用fuzzer工具通过我们写的代码，生成大量的畸形样本。
	- 让fuzzer 执行并监控被挖掘程序处理畸形样本的运行情况，检测程序是否发生异常，如果异常保留异常样本和相关信息。
	- 用OLLYDBG WINDBG IDA等工具深入分析崩溃信息，查看是否是漏洞同时确定危害级别。
	
	::
	
		优点：执行效率高，效果好。可以挖掘其他方法挖掘不到的软件漏洞。
		
	::
	
		缺点：需要深入研究相应的文件格式，并写出相应的文件格式脚本。该过程需要的时间较长。
	
	相关工具：Easyfuzzer。

.. |attackmushi| image:: ../images/attackmushi.jpeg
.. |web-sec-learn| image:: ../images/web-sec-learn.png
.. |STCS2| image:: ../images/STCS2.jpg
.. |STCS| image:: ../images/STCS-Mind-Map.png