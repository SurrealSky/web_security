防护策略
========================================

基本策略
----------------------------------------
+ 混淆机制
+ 签名保护
+ 手动注册native
+ 反调试检测

加固方案
----------------------------------------
+ dex加固原理
+ so加固原理
+ LLVM
+ 虚拟机壳

加固历史
----------------------------------------
+ 第一代-动态内存
+ 第二代-内存不落地加载
+ 第三代-指令抽取
+ 第四代-指令转换
+ 第五代-虚拟机壳保护

脱壳
----------------------------------------

基础
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+ 本质：对内存中处于解密状态的dex进行dump。

ROOR环境修复
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+ 隐藏magisk应用
	- magisk设置中，启用"隐藏Magisk应用"功能
+ magiskhide功能
	- magisk设置中，启用"MagiskHide"功能
	- 超级用户授权中，MagiskHide中选中对应的app

脱壳技术原理
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+ 关键因素
	- 确定内存中dex的起始地址和大小
	- 确定脱壳的时机，只有在dex解密后进行脱壳，这样才能dump出明文状态的dex。
+ dalvik虚拟机
	- 基于hook函数
		::
		
			通过hook系统关键函数进行dump内存数据也就是脱壳，
			例如dvmDexFileOpenPartial、DexFileParse等函数
+ ART虚拟机
	- 基于hook函数
		::
		
			通过hook系统函数openMemory、OpenAndReadMagic、DexFile::DexFile()函数
			进行dump内存数据也就是脱壳。

常见脱壳工具
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+ Fdex2
+ dexhunter
+ fupk3
+ fart
+ frida-dexdump
+ youpk